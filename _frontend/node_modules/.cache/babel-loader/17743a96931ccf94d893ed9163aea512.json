{"ast":null,"code":"var _jsxFileName = \"/home/rackham/dev/toggle/frontend/src/Components/Dashboard.tsx\";\nimport React, { Component } from 'react';\nimport styled from 'styled-components';\nimport PostCard from './PostCard';\nimport { connect } from 'react-redux';\nimport { getFeed } from '../actions/feedAction';\nimport { togglePrivacyPost } from '../actions/feedAction';\nimport Loading from './Loading';\nimport { deletePost } from '../actions/feedAction';\nimport { AuthContext } from \"../Context/AuthContext\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Dashboard extends Component {\n  constructor(props) {\n    super(props);\n    this.context = void 0;\n\n    this._deletePost = id => {\n      const params = {\n        id\n      };\n      this.setState({\n        id\n      }, this.props.deletePost(params));\n    };\n\n    this._togglePost = id => {\n      const params = {\n        id\n      };\n      this.setState({\n        id\n      }, this.props.getTogglePrivacy(params));\n    };\n\n    this.state = {\n      posts: [],\n      id: \"\"\n    };\n  }\n\n  componentDidMount() {\n    let ctx = this.context;\n\n    if (ctx && ctx.loggedin) {\n      this.props.getPosts();\n\n      if (ctx) {\n        ctx.socket.on(\"new-post\", _ref => {\n          let {\n            data\n          } = _ref;\n          this.setState({\n            posts: [data, ...this.state.posts]\n          });\n        });\n      }\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.posts && this.props.posts.data && this.props.posts.data !== prevProps.posts.data) {\n      this.setState({\n        posts: [...this.props.posts.data.posts]\n      });\n    }\n\n    if (this.props.deletePostResponse && this.props.deletePostResponse.data && this.props.deletePostResponse.data.success && this.props.deletePostResponse.data !== prevProps.deletePostResponse.data) {\n      const {\n        id\n      } = this.state;\n      this.setState({\n        posts: [...this.state.posts.filter(post => post._id !== id)],\n        id: \"\"\n      });\n    }\n\n    if (this.props.togglePrivacy && this.props.togglePrivacy.data && this.props.togglePrivacy.data.success && this.props.togglePrivacy.data !== prevProps.togglePrivacy.data) {\n      const {\n        id\n      } = this.state;\n      this.setState({\n        posts: [...this.state.posts.map(post => {\n          if (id === post._id) {\n            post.isPrivate = !post.isPrivate;\n            return post;\n          }\n\n          return post;\n        })],\n        id: \"\"\n      });\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(Container, {\n      children: /*#__PURE__*/_jsxDEV(PostContainer, {\n        children: this.state.posts.length > 0 ? this.state.posts.map(post => {\n          return /*#__PURE__*/_jsxDEV(PostCard, {\n            handleTogglePrivacy: this._togglePost,\n            handleDelete: this._deletePost,\n            data: post\n          }, post._id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 110,\n            columnNumber: 16\n          }, this);\n        }) : this.props.getPosts.loading ? /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 42\n        }, this) : /*#__PURE__*/_jsxDEV(Message, {\n          children: \"Share some memory to your wall\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 56\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 2\n    }, this);\n  }\n\n} // Dashboard.contextType = AuthContext;\n\n\nDashboard.contextType = AuthContext;\nconst Container = styled.div`\n  flex: 1;\n  width: 100%;\n  display: flex;\n  justify-content: center;\n`;\n_c = Container;\nconst PostContainer = styled.div`\n  width: 500px;\n  display: flex;\n  flex-direction: column;\n  gap: 20px;\n`;\n_c2 = PostContainer;\nconst Message = styled.h1`\n  color: #636e72;\n`;\n_c3 = Message;\n\nconst mapStateProps = state => {\n  return {\n    posts: state.dashboardFeed,\n    deletePostResponse: state.deletePost,\n    togglePrivacy: state.togglePrivacy\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    getPosts: () => dispatch(getFeed()),\n    deletePost: params => dispatch(deletePost(params)),\n    getTogglePrivacy: params => dispatch(togglePrivacyPost(params))\n  };\n};\n\nexport default connect(mapStateProps, mapDispatchToProps)(Dashboard);\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"Container\");\n$RefreshReg$(_c2, \"PostContainer\");\n$RefreshReg$(_c3, \"Message\");","map":{"version":3,"sources":["/home/rackham/dev/toggle/frontend/src/Components/Dashboard.tsx"],"names":["React","Component","styled","PostCard","connect","getFeed","togglePrivacyPost","Loading","deletePost","AuthContext","Dashboard","constructor","props","context","_deletePost","id","params","setState","_togglePost","getTogglePrivacy","state","posts","componentDidMount","ctx","loggedin","getPosts","socket","on","data","componentDidUpdate","prevProps","deletePostResponse","success","filter","post","_id","togglePrivacy","map","isPrivate","render","length","loading","contextType","Container","div","PostContainer","Message","h1","mapStateProps","dashboardFeed","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport styled from 'styled-components';\nimport PostCard from './PostCard';\nimport { connect } from 'react-redux';\nimport { PostParamsType } from '../interfacesAndTypes/RequestParams';\nimport { AppDispatch, RootState } from '../store';\nimport { getFeed } from '../actions/feedAction';\nimport { togglePrivacyPost } from '../actions/feedAction';\nimport Loading from './Loading';\nimport { deletePost } from '../actions/feedAction';\nimport { AuthContext, AuthContextType } from \"../Context/AuthContext\"\n\ntype Props = {\n  getPosts?: any,\n  posts?: any,\n  deletePost?: any,\n  deletePostResponse?: any\n  togglePrivacy?: any\n  getTogglePrivacy?: any\n}\n\ntype State = {\n  posts: any\n  id: string\n}\n\n\nclass Dashboard extends Component<Props, State> {\n\n  constructor(props: Props){\n    super(props);\n    this.state = {\n      posts: [],\n      id: \"\"\n    } \n  }\n\n  static contextType: React.Context<AuthContextType>= AuthContext;\n  context: any | null;\n  componentDidMount(){\n    let ctx = this.context;\n    if(ctx && ctx.loggedin){\n      this.props.getPosts();\n      if(ctx){\n        ctx.socket.on(\"new-post\", ({data}:any)=>{\n        this.setState({\n            posts: [data,...this.state.posts]\n        })\n      })\n      }\n    }\n  }\n  \n\n  componentDidUpdate(prevProps: Props){\n    if(this.props.posts && this.props.posts.data && this.props.posts.data !== prevProps.posts.data ){\n      this.setState({\n        posts: [...this.props.posts.data.posts]\n      })\n    }\n    if(this.props.deletePostResponse && this.props.deletePostResponse.data && this.props.deletePostResponse.data.success && this.props.deletePostResponse.data !== prevProps.deletePostResponse.data){\n      const { id } = this.state;\n      this.setState({\n        posts: [...this.state.posts.filter((post: any)=> post._id !== id)],\n        id: \"\"\n      })\n    }\n    if(this.props.togglePrivacy && this.props.togglePrivacy.data && this.props.togglePrivacy.data.success && this.props.togglePrivacy.data !== prevProps.togglePrivacy.data){\n      const { id } = this.state;\n      this.setState({\n        posts: [...this.state.posts.map((post: any)=> {\n          if(id === post._id){\n            post.isPrivate = !post.isPrivate;\n            return post;\n          }\n          return post;\n        })],\n        id: \"\"\n      })\n    }\n  }\n\n  _deletePost = (id:string)=>{\n    const params = {\n      id\n    }\n    this.setState({\n      id\n    },this.props.deletePost(params))\n    \n  }\n\n  _togglePost = (id: string)=>{\n    const params = {\n      id\n    }\n    this.setState({\n      id\n    }, this.props.getTogglePrivacy(params))\n    \n  }\n\n  render(){\n    \n  return (\n\t<Container>\n    <PostContainer>\n\n      {this.state.posts.length > 0  ? this.state.posts.map((post: PostParamsType)=>{\n        return <PostCard handleTogglePrivacy={this._togglePost} handleDelete={this._deletePost} key={post._id} data={post}/>\n      }) : this.props.getPosts.loading ? <Loading />  :<Message>Share some memory to your wall</Message> }\n    </PostContainer>\n  </Container>\n  )\n    }\n}\n\n// Dashboard.contextType = AuthContext;\n\nconst Container = styled.div`\n  flex: 1;\n  width: 100%;\n  display: flex;\n  justify-content: center;\n`\n\nconst PostContainer = styled.div`\n  width: 500px;\n  display: flex;\n  flex-direction: column;\n  gap: 20px;\n`\n\nconst Message = styled.h1`\n  color: #636e72;\n`\n\nconst mapStateProps = (state: RootState)=>{\n  return {\n    posts: state.dashboardFeed,\n    deletePostResponse: state.deletePost,\n    togglePrivacy: state.togglePrivacy\n  }\n}\n\n\nconst mapDispatchToProps = (dispatch: AppDispatch)=>{\n  return  {\n    getPosts: ()=> dispatch<any>(getFeed()),\n    deletePost: (params: any) => dispatch<any>(deletePost(params)),\n    getTogglePrivacy: (params:any) => dispatch<any>(togglePrivacyPost(params))\n  }\n}\n\nexport default connect(mapStateProps, mapDispatchToProps)(Dashboard)"]},"metadata":{},"sourceType":"module"}